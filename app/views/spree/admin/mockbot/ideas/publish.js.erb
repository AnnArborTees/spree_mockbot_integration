$('#start-publish').hide();
<% if @error %>
  alert('GOD WHY. STEP <%= @step %>');
  alert("<%=j @error.inspect %>")
<% elsif @complete %>
  $('.publish-step').removeClass('inactive');
  $('#publish-step-done').addClass('active');
<% else %>
  var $previous = $('#publish-step-<%= @step_number-1 %>');
  var $next     = $('#publish-step-<%= @step_number %>');

  if ($previous.length) $previous.removeClass('active');
  if ($next.length)     $next.addClass('inactive');

  $.ajax({
    url: "<%=j spree.admin_mockbot_idea_publish_path(@idea.sku) %>",
    type: 'POST',
    data: { step: "<%=j @step %>" },
    dataType: 'script'
  })

    .done(eval)

    .fail(function (jqXHR, textStatus) {
      alert('Server error, oh noooooooo');
    });
<% end %>
